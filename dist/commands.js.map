{"version":3,"file":"commands.js","mappings":"yBAAO,SAASA,EAAUC,GACtB,IAAIC,GAAY,IAAIC,MAAOC,cAC3B,MAAO,UAAUC,OAAOH,EAAW,MAAMG,OAAOJ,EACpD,CCHO,SAASK,EAAmBC,GAC/B,SAAIA,IACEA,EAAQC,SAAS,gBACfD,EAAQC,SAAS,cACjBD,EAAQC,SAAS,mBACjBD,EAAQC,SAAS,MACjBD,EAAQC,SAAS,KAI7B,CCHAC,OAAOC,QAAQ,WACX,GAiDJD,OAAOE,QAAQC,UAAU,SA3CzB,SAAgBC,GACZ,IAAIC,EACJC,QAAQC,IAAI,mEACZ,IAAIf,EAAU,CACVgB,KAAMR,OAAOS,aAAaC,4BAA4BC,qBACtDnB,QAAS,oBACToB,KAAM,aACNC,YAAY,GAEuB,QAAtCR,EAAKL,OAAOc,QAAQC,QAAQC,YAAyB,IAAPX,GAAyBA,EAAGY,qBAAqBC,aAAa,gCAAiC1B,GAC9IY,EAAMe,WACV,GAiCAnB,OAAOE,QAAQC,UAAU,cA5BzB,SAAqBC,GACjBE,QAAQC,IAAIhB,EAAU,oBACtB,IACI,IAAIyB,EAAOhB,OAAOc,QAAQC,QAAQC,KAElC,GADAV,QAAQC,IAAIhB,EAAU,QAASyB,GAC3BA,GAAQA,EAAKlB,QAAS,CACtB,IAAIA,EAAUkB,EAAKlB,QACnBQ,QAAQC,IAAIhB,EAAU,WAAYO,GAC9BD,EAAmBC,IACnBQ,QAAQC,IAAIhB,EAAU,sBAAuBM,GAEjDG,OAAOc,QAAQM,GAAGC,mBAAmB,6DAA6DzB,OAAO0B,mBAAmBxB,IAAW,CAAEyB,OAAQ,GAAIC,MAAO,IAAM,SAAUC,GACpKA,EAAOC,SAAW1B,OAAO2B,kBAAkBC,QAC3CtB,QAAQuB,MAAMtC,EAAU,2BAA4BkC,EAAOI,MAAMrC,QAEzE,EACJ,MAEIc,QAAQwB,KAAKvC,EAAU,gCAE3Ba,EAAMe,WACV,CACA,MAAOY,GACHzB,QAAQuB,MAAMtC,EAAU,2BAA4BwC,EACxD,CACJ,E","sources":["webpack://office-addin-taskpane-react/./src/util/log.ts","webpack://office-addin-taskpane-react/./src/util/mailitem.ts","webpack://office-addin-taskpane-react/./src/commands/commands.ts"],"sourcesContent":["export function formatLog(message) {\n    var timestamp = new Date().toISOString(); // ISO-formaat: 2025-10-10T12:39:00.000Z\n    return \"[VdSpek\".concat(timestamp, \"] \").concat(message);\n}\n","export function isQuotationRequest(subject) {\n    if (subject &&\n        ((subject.includes(\"Prijsopgave\") ||\n            subject.includes(\"Quotation\") ||\n            subject.includes(\"Preisauskunft\")) &&\n            subject.includes(\"[\") &&\n            subject.includes(\"]\"))) {\n        return true;\n    }\n    return false;\n}\nexport function getReferenceFromSubject(subject) {\n    /*\n      Voorbeeld subject:\n  \n      Prijsopgave - [2603] Hyster H 4.00 XLS-6 - Van der Spek Heftrucks B.V. (ref. 2016.00000283)\n  \n      2019-09-20 aanpassing in subject door VIP\n      Prijsopgave - [Heftruck; 3216] Toyota 02-8 FDF 25 - Van der Spek Heftrucks B.V. (ref nr 2019.00002871)\n    */\n    // Met regex het laatste nummer uitlezen/matchen\n    var regex = /([0-9.]*[0-9]*?)\\)/;\n    var match = subject.match(regex);\n    if (!match || match.length < 2) {\n        throw new Error(\"Kan referentienummer niet achterhalen.\");\n    }\n    var reference = match[1];\n    // Verwijder het laatste haakje (voor de zekerheid)\n    return reference.replace(/\\)+$/, '');\n}\nexport function getMachineNumberFromSubject(subject) {\n    var regex = /\\[(\\d+)\\]/;\n    var match = subject.match(regex);\n    if (!match || match.length < 2) {\n        throw new Error(\"Geen machinenummer gevonden in het onderwerp van de mail.\");\n    }\n    return match[1];\n}\n","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\nimport { formatLog } from \"../util/log\";\nimport { isQuotationRequest } from \"../util/mailitem\";\n/* global Office */\nOffice.onReady(function () {\n    // Office.js is ready to be called.\n});\n/**\n * Shows a notification when the add-in command is executed.\n * @param event\n */\nfunction action(event) {\n    var _a;\n    console.log(\"Action to show notification when the add-in command is executed\");\n    var message = {\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n        message: \"Performed action.\",\n        icon: \"Icon.80x80\",\n        persistent: true,\n    };\n    (_a = Office.context.mailbox.item) === null || _a === void 0 ? void 0 : _a.notificationMessages.replaceAsync(\"ActionPerformanceNotification\", message);\n    event.completed();\n}\n/**\n * Opens a dialog showing the subject of the selected email.\n * @param event\n */\nfunction readSubject(event) {\n    console.log(formatLog(\"Read subject...\"));\n    try {\n        var item = Office.context.mailbox.item;\n        console.log(formatLog(\"item\"), item);\n        if (item && item.subject) {\n            var subject = item.subject;\n            console.log(formatLog(\"Subject\"), subject);\n            if (isQuotationRequest(subject)) {\n                console.log(formatLog(\"isQuotationRequest\"), isQuotationRequest);\n            }\n            Office.context.ui.displayDialogAsync(\"https://webit01.github.io/vdspek/dist/dialog.html?subject=\".concat(encodeURIComponent(subject)), { height: 30, width: 40 }, function (result) {\n                if (result.status === Office.AsyncResultStatus.Failed) {\n                    console.error(formatLog(\"Dialoog openen mislukt:\"), result.error.message);\n                }\n            });\n        }\n        else {\n            console.warn(formatLog(\"Geen onderwerp beschikbaar.\"));\n        }\n        event.completed();\n    }\n    catch (e) {\n        console.error(formatLog(\"Error when read subject\"), e);\n    }\n}\n// Register the functions with Office\nOffice.actions.associate(\"action\", action);\nOffice.actions.associate(\"readSubject\", readSubject);\n"],"names":["formatLog","message","timestamp","Date","toISOString","concat","isQuotationRequest","subject","includes","Office","onReady","actions","associate","event","_a","console","log","type","MailboxEnums","ItemNotificationMessageType","InformationalMessage","icon","persistent","context","mailbox","item","notificationMessages","replaceAsync","completed","ui","displayDialogAsync","encodeURIComponent","height","width","result","status","AsyncResultStatus","Failed","error","warn","e"],"sourceRoot":""}